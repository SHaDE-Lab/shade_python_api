import json
from .routing import *
from django.http import HttpResponse


# Create your views here.
def get_route(request, coords):
    load = json.loads(coords)
    start = tuple(load['startPoint'])
    end = tuple(load['endPoint'])
    date_time = load['dateTime']
    date_time = '2023-4-8-2100'

    path = calculate_route((start[1], start[0]), (end[1], end[0]), date_time)

    # line below is temporary and purely for testing purposes, delete it when model is hooked up
    # path = [[1.1, 2.2], [3.3, 4.4], [5.5, 6.6], [7.7, 8.8]]
    #path = [[412647.7981374912, 3698659.8188277525], [412647.7981374912, 3698658.8188277525], [412647.7981374912, 3698657.8188277525], [412647.7981374912, 3698656.8188277525], [412647.7981374912, 3698655.8188277525], [412647.7981374912, 3698654.8188277525], [412647.7981374912, 3698653.8188277525], [412647.7981374912, 3698652.8188277525], [412647.7981374912, 3698651.8188277525], [412647.7981374912, 3698650.8188277525], [412647.7981374912, 3698649.8188277525], [412647.7981374912, 3698648.8188277525], [412647.7981374912, 3698647.8188277525], [412647.7981374912, 3698646.8188277525], [412647.7981374912, 3698645.8188277525], [412647.7981374912, 3698644.8188277525], [412647.7981374912, 3698643.8188277525], [412647.7981374912, 3698642.8188277525], [412647.7981374912, 3698641.8188277525], [412647.7981374912, 3698640.8188277525], [412647.7981374912, 3698639.8188277525], [412648.7981374912, 3698638.8188277525], [412649.7981374912, 3698637.8188277525], [412650.7981374912, 3698636.8188277525], [412651.7981374912, 3698635.8188277525], [412652.7981374912, 3698634.8188277525], [412653.7981374912, 3698633.8188277525], [412654.7981374912, 3698632.8188277525], [412655.7981374912, 3698631.8188277525], [412656.7981374912, 3698630.8188277525], [412657.7981374912, 3698629.8188277525], [412658.7981374912, 3698628.8188277525], [412659.7981374912, 3698627.8188277525], [412660.7981374912, 3698626.8188277525], [412661.7981374912, 3698625.8188277525], [412662.7981374912, 3698624.8188277525], [412663.7981374912, 3698623.8188277525], [412664.7981374912, 3698622.8188277525], [412665.7981374912, 3698621.8188277525], [412665.7981374912, 3698620.8188277525], [412665.7981374912, 3698619.8188277525], [412665.7981374912, 3698618.8188277525], [412665.7981374912, 3698617.8188277525], [412665.7981374912, 3698616.8188277525], [412665.7981374912, 3698615.8188277525], [412665.7981374912, 3698614.8188277525], [412665.7981374912, 3698613.8188277525], [412664.7981374912, 3698612.8188277525], [412664.7981374912, 3698611.8188277525], [412664.7981374912, 3698610.8188277525], [412664.7981374912, 3698609.8188277525], [412664.7981374912, 3698608.8188277525], [412664.7981374912, 3698607.8188277525], [412664.7981374912, 3698606.8188277525], [412664.7981374912, 3698605.8188277525], [412664.7981374912, 3698604.8188277525], [412664.7981374912, 3698603.8188277525], [412664.7981374912, 3698602.8188277525], [412664.7981374912, 3698601.8188277525], [412664.7981374912, 3698600.8188277525], [412664.7981374912, 3698599.8188277525], [412664.7981374912, 3698598.8188277525], [412664.7981374912, 3698597.8188277525], [412664.7981374912, 3698596.8188277525], [412664.7981374912, 3698595.8188277525], [412664.7981374912, 3698594.8188277525], [412664.7981374912, 3698593.8188277525], [412664.7981374912, 3698592.8188277525], [412664.7981374912, 3698591.8188277525], [412664.7981374912, 3698590.8188277525], [412664.7981374912, 3698589.8188277525], [412664.7981374912, 3698588.8188277525], [412665.7981374912, 3698587.8188277525], [412665.7981374912, 3698586.8188277525], [412665.7981374912, 3698585.8188277525], [412665.7981374912, 3698584.8188277525], [412665.7981374912, 3698583.8188277525], [412665.7981374912, 3698582.8188277525], [412665.7981374912, 3698581.8188277525], [412665.7981374912, 3698580.8188277525], [412665.7981374912, 3698579.8188277525], [412665.7981374912, 3698578.8188277525], [412665.7981374912, 3698577.8188277525], [412665.7981374912, 3698576.8188277525], [412665.7981374912, 3698575.8188277525], [412665.7981374912, 3698574.8188277525], [412664.7981374912, 3698573.8188277525], [412663.7981374912, 3698572.8188277525], [412663.7981374912, 3698571.8188277525], [412663.7981374912, 3698570.8188277525], [412663.7981374912, 3698569.8188277525], [412663.7981374912, 3698568.8188277525], [412663.7981374912, 3698567.8188277525], [412663.7981374912, 3698566.8188277525], [412663.7981374912, 3698565.8188277525], [412663.7981374912, 3698564.8188277525], [412663.7981374912, 3698563.8188277525], [412664.7981374912, 3698562.8188277525], [412665.7981374912, 3698561.8188277525], [412666.7981374912, 3698560.8188277525], [412666.7981374912, 3698559.8188277525], [412667.7981374912, 3698558.8188277525], [412668.7981374912, 3698557.8188277525], [412668.7981374912, 3698556.8188277525], [412669.7981374912, 3698555.8188277525], [412670.7981374912, 3698554.8188277525], [412670.7981374912, 3698553.8188277525], [412669.7981374912, 3698552.8188277525], [412668.7981374912, 3698551.8188277525], [412668.7981374912, 3698550.8188277525], [412668.7981374912, 3698549.8188277525], [412668.7981374912, 3698548.8188277525], [412668.7981374912, 3698547.8188277525], [412668.7981374912, 3698546.8188277525], [412669.7981374912, 3698545.8188277525], [412670.7981374912, 3698544.8188277525], [412671.7981374912, 3698543.8188277525], [412672.7981374912, 3698542.8188277525], [412672.7981374912, 3698541.8188277525], [412672.7981374912, 3698540.8188277525], [412672.7981374912, 3698539.8188277525], [412672.7981374912, 3698538.8188277525], [412672.7981374912, 3698537.8188277525], [412672.7981374912, 3698536.8188277525], [412673.7981374912, 3698535.8188277525], [412674.7981374912, 3698534.8188277525], [412675.7981374912, 3698533.8188277525], [412676.7981374912, 3698532.8188277525], [412676.7981374912, 3698531.8188277525], [412676.7981374912, 3698530.8188277525], [412676.7981374912, 3698529.8188277525], [412677.7981374912, 3698528.8188277525], [412677.7981374912, 3698527.8188277525], [412678.7981374912, 3698526.8188277525], [412678.7981374912, 3698525.8188277525], [412678.7981374912, 3698524.8188277525], [412678.7981374912, 3698523.8188277525], [412678.7981374912, 3698522.8188277525], [412678.7981374912, 3698521.8188277525], [412679.7981374912, 3698520.8188277525], [412680.7981374912, 3698519.8188277525], [412680.7981374912, 3698518.8188277525], [412680.7981374912, 3698517.8188277525], [412680.7981374912, 3698516.8188277525], [412680.7981374912, 3698515.8188277525], [412680.7981374912, 3698514.8188277525], [412680.7981374912, 3698513.8188277525], [412680.7981374912, 3698512.8188277525], [412681.7981374912, 3698511.8188277525], [412682.7981374912, 3698510.8188277525], [412682.7981374912, 3698509.8188277525], [412683.7981374912, 3698508.8188277525], [412683.7981374912, 3698507.8188277525], [412683.7981374912, 3698506.8188277525], [412683.7981374912, 3698505.8188277525], [412683.7981374912, 3698504.8188277525], [412683.7981374912, 3698503.8188277525], [412683.7981374912, 3698502.8188277525], [412683.7981374912, 3698501.8188277525], [412683.7981374912, 3698500.8188277525], [412683.7981374912, 3698499.8188277525], [412683.7981374912, 3698498.8188277525], [412683.7981374912, 3698497.8188277525], [412683.7981374912, 3698496.8188277525], [412683.7981374912, 3698495.8188277525], [412684.7981374912, 3698494.8188277525], [412685.7981374912, 3698493.8188277525], [412686.7981374912, 3698492.8188277525], [412686.7981374912, 3698491.8188277525], [412687.7981374912, 3698490.8188277525], [412688.7981374912, 3698489.8188277525], [412689.7981374912, 3698488.8188277525], [412690.7981374912, 3698487.8188277525], [412691.7981374912, 3698486.8188277525], [412692.7981374912, 3698485.8188277525], [412692.7981374912, 3698484.8188277525], [412692.7981374912, 3698483.8188277525], [412692.7981374912, 3698482.8188277525], [412692.7981374912, 3698481.8188277525], [412692.7981374912, 3698480.8188277525], [412692.7981374912, 3698479.8188277525], [412692.7981374912, 3698478.8188277525], [412692.7981374912, 3698477.8188277525], [412692.7981374912, 3698476.8188277525], [412692.7981374912, 3698475.8188277525], [412692.7981374912, 3698474.8188277525], [412692.7981374912, 3698473.8188277525], [412692.7981374912, 3698472.8188277525], [412692.7981374912, 3698471.8188277525], [412692.7981374912, 3698470.8188277525], [412692.7981374912, 3698469.8188277525], [412692.7981374912, 3698468.8188277525], [412692.7981374912, 3698467.8188277525], [412692.7981374912, 3698466.8188277525], [412692.7981374912, 3698465.8188277525], [412692.7981374912, 3698464.8188277525], [412692.7981374912, 3698463.8188277525], [412692.7981374912, 3698462.8188277525], [412692.7981374912, 3698461.8188277525], [412692.7981374912, 3698460.8188277525], [412692.7981374912, 3698459.8188277525], [412692.7981374912, 3698458.8188277525], [412692.7981374912, 3698457.8188277525], [412692.7981374912, 3698456.8188277525], [412692.7981374912, 3698455.8188277525], [412692.7981374912, 3698454.8188277525], [412692.7981374912, 3698453.8188277525], [412692.7981374912, 3698452.8188277525], [412692.7981374912, 3698451.8188277525], [412693.7981374912, 3698450.8188277525], [412694.7981374912, 3698449.8188277525], [412695.7981374912, 3698448.8188277525], [412695.7981374912, 3698447.8188277525], [412695.7981374912, 3698446.8188277525], [412695.7981374912, 3698445.8188277525], [412695.7981374912, 3698444.8188277525], [412696.7981374912, 3698443.8188277525], [412697.7981374912, 3698442.8188277525], [412698.7981374912, 3698441.8188277525], [412698.7981374912, 3698440.8188277525], [412698.7981374912, 3698439.8188277525], [412698.7981374912, 3698438.8188277525], [412698.7981374912, 3698437.8188277525], [412698.7981374912, 3698436.8188277525], [412698.7981374912, 3698435.8188277525], [412698.7981374912, 3698434.8188277525], [412698.7981374912, 3698433.8188277525], [412698.7981374912, 3698432.8188277525], [412698.7981374912, 3698431.8188277525], [412698.7981374912, 3698430.8188277525], [412698.7981374912, 3698429.8188277525], [412698.7981374912, 3698428.8188277525], [412699.7981374912, 3698427.8188277525], [412700.7981374912, 3698426.8188277525], [412700.7981374912, 3698425.8188277525], [412700.7981374912, 3698424.8188277525], [412700.7981374912, 3698423.8188277525], [412700.7981374912, 3698422.8188277525], [412700.7981374912, 3698421.8188277525], [412701.7981374912, 3698420.8188277525], [412702.7981374912, 3698419.8188277525], [412702.7981374912, 3698418.8188277525], [412702.7981374912, 3698417.8188277525],
       # [412702.7981374912, 3698416.8188277525], [412702.7981374912, 3698415.8188277525], [412702.7981374912, 3698414.8188277525], [412702.7981374912, 3698413.8188277525], [412702.7981374912, 3698412.8188277525], [412702.7981374912, 3698411.8188277525], [412702.7981374912, 3698410.8188277525], [412702.7981374912, 3698409.8188277525], [412702.7981374912, 3698408.8188277525], [412702.7981374912, 3698407.8188277525], [412702.7981374912, 3698406.8188277525], [412702.7981374912, 3698405.8188277525], [412703.7981374912, 3698404.8188277525], [412703.7981374912, 3698403.8188277525], [412703.7981374912, 3698402.8188277525], [412703.7981374912, 3698401.8188277525], [412704.7981374912, 3698400.8188277525], [412705.7981374912, 3698399.8188277525], [412705.7981374912, 3698398.8188277525], [412706.7981374912, 3698397.8188277525], [412706.7981374912, 3698396.8188277525], [412707.7981374912, 3698395.8188277525], [412708.7981374912, 3698394.8188277525], [412709.7981374912, 3698393.8188277525], [412709.7981374912, 3698392.8188277525], [412710.7981374912, 3698391.8188277525], [412711.7981374912, 3698390.8188277525], [412712.7981374912, 3698389.8188277525], [412713.7981374912, 3698388.8188277525], [412714.7981374912, 3698387.8188277525], [412715.7981374912, 3698386.8188277525], [412716.7981374912, 3698385.8188277525], [412717.7981374912, 3698384.8188277525], [412718.7981374912, 3698383.8188277525], [412719.7981374912, 3698382.8188277525], [412720.7981374912, 3698381.8188277525], [412720.7981374912, 3698380.8188277525], [412721.7981374912, 3698379.8188277525], [412722.7981374912, 3698378.8188277525], [412723.7981374912, 3698377.8188277525], [412724.7981374912, 3698376.8188277525], [412725.7981374912, 3698375.8188277525], [412725.7981374912, 3698374.8188277525], [412725.7981374912, 3698373.8188277525], [412725.7981374912, 3698372.8188277525], [412725.7981374912, 3698371.8188277525], [412726.7981374912, 3698370.8188277525], [412727.7981374912, 3698369.8188277525], [412728.7981374912, 3698368.8188277525], [412729.7981374912, 3698367.8188277525], [412730.7981374912, 3698366.8188277525], [412731.7981374912, 3698365.8188277525], [412732.7981374912, 3698364.8188277525], [412733.7981374912, 3698363.8188277525], [412734.7981374912, 3698362.8188277525], [412734.7981374912, 3698361.8188277525], [412734.7981374912, 3698360.8188277525], [412734.7981374912, 3698359.8188277525], [412735.7981374912, 3698358.8188277525], [412736.7981374912, 3698357.8188277525], [412737.7981374912, 3698356.8188277525], [412738.7981374912, 3698355.8188277525], [412739.7981374912, 3698354.8188277525], [412740.7981374912, 3698353.8188277525], [412741.7981374912, 3698352.8188277525], [412742.7981374912, 3698352.8188277525], [412743.7981374912, 3698352.8188277525], [412744.7981374912, 3698352.8188277525], [412745.7981374912, 3698352.8188277525], [412746.7981374912, 3698352.8188277525], [412747.7981374912, 3698352.8188277525], [412748.7981374912, 3698352.8188277525], [412749.7981374912, 3698351.8188277525], [412750.7981374912, 3698351.8188277525], [412751.7981374912, 3698351.8188277525], [412752.7981374912, 3698351.8188277525], [412753.7981374912, 3698351.8188277525], [412754.7981374912, 3698350.8188277525], [412755.7981374912, 3698349.8188277525], [412756.7981374912, 3698348.8188277525], [412757.7981374912, 3698347.8188277525], [412758.7981374912, 3698346.8188277525], [412759.7981374912, 3698345.8188277525], [412760.7981374912, 3698344.8188277525], [412761.7981374912, 3698343.8188277525], [412762.7981374912, 3698342.8188277525], [412763.7981374912, 3698341.8188277525], [412764.7981374912, 3698340.8188277525], [412765.7981374912, 3698339.8188277525], [412766.7981374912, 3698338.8188277525], [412767.7981374912, 3698337.8188277525], [412768.7981374912, 3698336.8188277525], [412769.7981374912, 3698335.8188277525], [412770.7981374912, 3698334.8188277525], [412770.7981374912, 3698333.8188277525], [412771.7981374912, 3698332.8188277525], [412772.7981374912, 3698331.8188277525], [412772.7981374912, 3698330.8188277525], [412772.7981374912, 3698329.8188277525], [412773.7981374912, 3698328.8188277525], [412774.7981374912, 3698327.8188277525], [412775.7981374912, 3698326.8188277525], [412776.7981374912, 3698325.8188277525], [412777.7981374912, 3698324.8188277525], [412778.7981374912, 3698323.8188277525], [412778.7981374912, 3698322.8188277525], [412778.7981374912, 3698321.8188277525], [412778.7981374912, 3698320.8188277525], [412778.7981374912, 3698319.8188277525], [412778.7981374912, 3698318.8188277525], [412779.7981374912, 3698317.8188277525], [412780.7981374912, 3698316.8188277525], [412781.7981374912, 3698315.8188277525], [412782.7981374912, 3698314.8188277525], [412783.7981374912, 3698313.8188277525], [412784.7981374912, 3698312.8188277525], [412785.7981374912, 3698311.8188277525], [412786.7981374912, 3698310.8188277525], [412786.7981374912, 3698309.8188277525], [412787.7981374912, 3698308.8188277525], [412787.7981374912, 3698307.8188277525], [412787.7981374912, 3698306.8188277525], [412786.7981374912, 3698305.8188277525], [412786.7981374912, 3698304.8188277525], [412786.7981374912, 3698303.8188277525], [412786.7981374912, 3698302.8188277525], [412786.7981374912, 3698301.8188277525], [412786.7981374912, 3698300.8188277525], [412786.7981374912, 3698299.8188277525], [412786.7981374912, 3698298.8188277525], [412786.7981374912, 3698297.8188277525], [412786.7981374912, 3698296.8188277525], [412786.7981374912, 3698295.8188277525], [412786.7981374912, 3698294.8188277525], [412787.7981374912, 3698293.8188277525], [412787.7981374912, 3698292.8188277525], [412787.7981374912, 3698291.8188277525], [412788.7981374912, 3698290.8188277525], [412789.7981374912, 3698289.8188277525], [412790.7981374912, 3698288.8188277525], [412791.7981374912, 3698287.8188277525], [412792.7981374912, 3698286.8188277525], [412793.7981374912, 3698285.8188277525], [412794.7981374912, 3698284.8188277525], [412795.7981374912, 3698283.8188277525], [412796.7981374912, 3698282.8188277525], [412797.7981374912, 3698281.8188277525], [412798.7981374912, 3698280.8188277525], [412799.7981374912, 3698279.8188277525], [412800.7981374912, 3698278.8188277525], [412801.7981374912, 3698277.8188277525], [412801.7981374912, 3698276.8188277525], [412802.7981374912, 3698275.8188277525], [412803.7981374912, 3698274.8188277525], [412804.7981374912, 3698273.8188277525], [412805.7981374912, 3698272.8188277525], [412805.7981374912, 3698271.8188277525], [412805.7981374912, 3698270.8188277525], [412805.7981374912, 3698269.8188277525], [412805.7981374912, 3698268.8188277525], [412806.7981374912, 3698267.8188277525], [412805.7981374912, 3698266.8188277525], [412805.7981374912, 3698265.8188277525], [412805.7981374912, 3698264.8188277525], [412805.7981374912, 3698263.8188277525], [412805.7981374912, 3698262.8188277525], [412805.7981374912, 3698261.8188277525], [412805.7981374912, 3698260.8188277525], [412805.7981374912, 3698259.8188277525], [412805.7981374912, 3698258.8188277525], [412805.7981374912, 3698257.8188277525], [412805.7981374912, 3698256.8188277525], [412805.7981374912, 3698255.8188277525], [412805.7981374912, 3698254.8188277525], [412805.7981374912, 3698253.8188277525], [412805.7981374912, 3698252.8188277525], [412805.7981374912, 3698251.8188277525], [412805.7981374912, 3698250.8188277525], [412804.7981374912, 3698249.8188277525], [412803.7981374912, 3698248.8188277525], [412803.7981374912, 3698247.8188277525], [412803.7981374912, 3698246.8188277525], [412803.7981374912, 3698245.8188277525], [412803.7981374912, 3698244.8188277525], [412802.7981374912, 3698243.8188277525], [412801.7981374912, 3698242.8188277525], [412801.7981374912, 3698241.8188277525], [412801.7981374912, 3698240.8188277525], [412801.7981374912, 3698239.8188277525], [412800.7981374912, 3698238.8188277525], [412799.7981374912, 3698237.8188277525], [412798.7981374912, 3698236.8188277525], [412797.7981374912, 3698235.8188277525], [412797.7981374912, 3698234.8188277525], [412796.7981374912, 3698233.8188277525], [412796.7981374912, 3698232.8188277525], [412796.7981374912, 3698231.8188277525], [412796.7981374912, 3698230.8188277525], [412796.7981374912, 3698229.8188277525], [412796.7981374912, 3698228.8188277525], [412796.7981374912, 3698227.8188277525], [412796.7981374912, 3698226.8188277525], [412797.7981374912, 3698225.8188277525], [412797.7981374912, 3698224.8188277525], [412798.7981374912, 3698223.8188277525], [412798.7981374912, 3698222.8188277525], [412798.7981374912, 3698221.8188277525], [412798.7981374912, 3698220.8188277525], [412798.7981374912, 3698219.8188277525], [412798.7981374912, 3698218.8188277525], [412798.7981374912, 3698217.8188277525], [412798.7981374912, 3698216.8188277525], [412798.7981374912, 3698215.8188277525], [412798.7981374912, 3698214.8188277525], [412798.7981374912, 3698213.8188277525], [412798.7981374912, 3698212.8188277525], [412798.7981374912, 3698211.8188277525], [412798.7981374912, 3698210.8188277525], [412798.7981374912, 3698209.8188277525], [412798.7981374912, 3698208.8188277525], [412798.7981374912, 3698207.8188277525], [412798.7981374912, 3698206.8188277525], [412798.7981374912, 3698205.8188277525], [412798.7981374912, 3698204.8188277525], [412798.7981374912, 3698203.8188277525], [412798.7981374912, 3698202.8188277525], [412798.7981374912, 3698201.8188277525], [412798.7981374912, 3698200.8188277525], [412798.7981374912, 3698199.8188277525], [412798.7981374912, 3698198.8188277525], [412798.7981374912, 3698197.8188277525], [412798.7981374912, 3698196.8188277525], [412798.7981374912, 3698195.8188277525], [412798.7981374912, 3698194.8188277525], [412798.7981374912, 3698193.8188277525], [412798.7981374912, 3698192.8188277525], [412798.7981374912, 3698191.8188277525], [412798.7981374912, 3698190.8188277525], [412798.7981374912, 3698189.8188277525], [412798.7981374912, 3698188.8188277525], [412798.7981374912, 3698187.8188277525], [412798.7981374912, 3698186.8188277525], [412798.7981374912, 3698185.8188277525],
        #[412798.7981374912, 3698184.8188277525], [412798.7981374912, 3698183.8188277525], [412798.7981374912, 3698182.8188277525], [412798.7981374912, 3698181.8188277525], [412798.7981374912, 3698180.8188277525], [412798.7981374912, 3698179.8188277525], [412798.7981374912, 3698178.8188277525], [412798.7981374912, 3698177.8188277525], [412798.7981374912, 3698176.8188277525], [412798.7981374912, 3698175.8188277525], [412798.7981374912, 3698174.8188277525], [412798.7981374912, 3698173.8188277525], [412798.7981374912, 3698172.8188277525], [412798.7981374912, 3698171.8188277525], [412798.7981374912, 3698170.8188277525], [412798.7981374912, 3698169.8188277525], [412798.7981374912, 3698168.8188277525], [412798.7981374912, 3698167.8188277525], [412798.7981374912, 3698166.8188277525], [412798.7981374912, 3698165.8188277525], [412798.7981374912, 3698164.8188277525], [412798.7981374912, 3698163.8188277525], [412798.7981374912, 3698162.8188277525], [412798.7981374912, 3698161.8188277525], [412798.7981374912, 3698160.8188277525], [412798.7981374912, 3698159.8188277525], [412798.7981374912, 3698158.8188277525], [412798.7981374912, 3698157.8188277525], [412798.7981374912, 3698156.8188277525], [412798.7981374912, 3698155.8188277525], [412798.7981374912, 3698154.8188277525], [412798.7981374912, 3698153.8188277525], [412799.7981374912, 3698152.8188277525], [412800.7981374912, 3698151.8188277525], [412801.7981374912, 3698150.8188277525], [412802.7981374912, 3698150.8188277525], [412803.7981374912, 3698149.8188277525], [412804.7981374912, 3698148.8188277525], [412805.7981374912, 3698148.8188277525], [412806.7981374912, 3698147.8188277525], [412807.7981374912, 3698146.8188277525], [412808.7981374912, 3698145.8188277525], [412809.7981374912, 3698144.8188277525], [412810.7981374912, 3698143.8188277525], [412811.7981374912, 3698142.8188277525], [412812.7981374912, 3698141.8188277525], [412813.7981374912, 3698140.8188277525], [412814.7981374912, 3698139.8188277525], [412815.7981374912, 3698138.8188277525], [412815.7981374912, 3698137.8188277525], [412815.7981374912, 3698136.8188277525], [412816.7981374912, 3698135.8188277525], [412816.7981374912, 3698134.8188277525], [412816.7981374912, 3698133.8188277525], [412816.7981374912, 3698132.8188277525], [412816.7981374912, 3698131.8188277525], [412816.7981374912, 3698130.8188277525], [412816.7981374912, 3698129.8188277525], [412816.7981374912, 3698128.8188277525], [412816.7981374912, 3698127.8188277525], [412816.7981374912, 3698126.8188277525], [412817.7981374912, 3698125.8188277525], [412818.7981374912, 3698124.8188277525], [412818.7981374912, 3698123.8188277525], [412818.7981374912, 3698122.8188277525], [412818.7981374912, 3698121.8188277525], [412819.7981374912, 3698120.8188277525], [412819.7981374912, 3698119.8188277525], [412819.7981374912, 3698118.8188277525], [412820.7981374912, 3698117.8188277525], [412821.7981374912, 3698116.8188277525], [412821.7981374912, 3698115.8188277525], [412821.7981374912, 3698114.8188277525], [412822.7981374912, 3698113.8188277525], [412822.7981374912, 3698112.8188277525], [412823.7981374912, 3698111.8188277525], [412824.7981374912, 3698110.8188277525], [412825.7981374912, 3698109.8188277525], [412826.7981374912, 3698108.8188277525], [412827.7981374912, 3698107.8188277525], [412827.7981374912, 3698106.8188277525], [412828.7981374912, 3698105.8188277525], [412829.7981374912, 3698104.8188277525], [412830.7981374912, 3698103.8188277525], [412830.7981374912, 3698102.8188277525], [412831.7981374912, 3698101.8188277525], [412832.7981374912, 3698100.8188277525], [412833.7981374912, 3698099.8188277525], [412834.7981374912, 3698098.8188277525], [412834.7981374912, 3698097.8188277525], [412833.7981374912, 3698096.8188277525], [412833.7981374912, 3698095.8188277525], [412833.7981374912, 3698094.8188277525], [412832.7981374912, 3698093.8188277525], [412831.7981374912, 3698092.8188277525], [412831.7981374912, 3698091.8188277525], [412831.7981374912, 3698090.8188277525], [412831.7981374912, 3698089.8188277525], [412831.7981374912, 3698088.8188277525], [412831.7981374912, 3698087.8188277525], [412832.7981374912, 3698086.8188277525], [412833.7981374912, 3698085.8188277525], [412834.7981374912, 3698084.8188277525], [412835.7981374912, 3698083.8188277525], [412836.7981374912, 3698082.8188277525], [412836.7981374912, 3698081.8188277525], [412836.7981374912, 3698080.8188277525], [412837.7981374912, 3698079.8188277525], [412838.7981374912, 3698078.8188277525], [412839.7981374912, 3698077.8188277525], [412840.7981374912, 3698076.8188277525], [412841.7981374912, 3698075.8188277525], [412842.7981374912, 3698074.8188277525], [412843.7981374912, 3698073.8188277525], [412844.7981374912, 3698072.8188277525], [412845.7981374912, 3698071.8188277525], [412846.7981374912, 3698070.8188277525], [412847.7981374912, 3698069.8188277525], [412848.7981374912, 3698068.8188277525], [412849.7981374912, 3698067.8188277525], [412850.7981374912, 3698066.8188277525], [412851.7981374912, 3698065.8188277525], [412852.7981374912, 3698064.8188277525], [412853.7981374912, 3698063.8188277525], [412854.7981374912, 3698062.8188277525], [412855.7981374912, 3698061.8188277525], [412856.7981374912, 3698060.8188277525], [412857.7981374912, 3698059.8188277525], [412858.7981374912, 3698058.8188277525], [412859.7981374912, 3698057.8188277525], [412860.7981374912, 3698056.8188277525], [412861.7981374912, 3698055.8188277525], [412862.7981374912, 3698054.8188277525], [412863.7981374912, 3698053.8188277525], [412864.7981374912, 3698052.8188277525], [412864.7981374912, 3698051.8188277525], [412864.7981374912, 3698050.8188277525], [412864.7981374912, 3698049.8188277525], [412864.7981374912, 3698048.8188277525], [412865.7981374912, 3698047.8188277525], [412866.7981374912, 3698046.8188277525], [412866.7981374912, 3698045.8188277525], [412866.7981374912, 3698044.8188277525], [412866.7981374912, 3698043.8188277525], [412866.7981374912, 3698042.8188277525], [412866.7981374912, 3698041.8188277525], [412866.7981374912, 3698040.8188277525], [412866.7981374912, 3698039.8188277525], [412867.7981374912, 3698038.8188277525], [412868.7981374912, 3698037.8188277525], [412869.7981374912, 3698036.8188277525], [412870.7981374912, 3698035.8188277525], [412870.7981374912, 3698034.8188277525], [412870.7981374912, 3698033.8188277525], [412870.7981374912, 3698032.8188277525], [412871.7981374912, 3698031.8188277525], [412871.7981374912, 3698030.8188277525], [412871.7981374912, 3698029.8188277525], [412871.7981374912, 3698028.8188277525], [412871.7981374912, 3698027.8188277525], [412871.7981374912, 3698026.8188277525], [412871.7981374912, 3698025.8188277525], [412871.7981374912, 3698024.8188277525], [412871.7981374912, 3698023.8188277525], [412871.7981374912, 3698022.8188277525], [412871.7981374912, 3698021.8188277525], [412871.7981374912, 3698020.8188277525], [412871.7981374912, 3698019.8188277525], [412871.7981374912, 3698018.8188277525], [412871.7981374912, 3698017.8188277525], [412871.7981374912, 3698016.8188277525], [412871.7981374912, 3698015.8188277525], [412871.7981374912, 3698014.8188277525], [412871.7981374912, 3698013.8188277525], [412871.7981374912, 3698012.8188277525], [412871.7981374912, 3698011.8188277525], [412871.7981374912, 3698010.8188277525], [412872.7981374912, 3698009.8188277525], [412872.7981374912, 3698008.8188277525], [412872.7981374912, 3698007.8188277525], [412872.7981374912, 3698006.8188277525], [412872.7981374912, 3698005.8188277525], [412872.7981374912, 3698004.8188277525], [412872.7981374912, 3698003.8188277525], [412872.7981374912, 3698002.8188277525], [412872.7981374912, 3698001.8188277525], [412872.7981374912, 3698000.8188277525], [412872.7981374912, 3697999.8188277525], [412872.7981374912, 3697998.8188277525], [412872.7981374912, 3697997.8188277525], [412872.7981374912, 3697996.8188277525], [412872.7981374912, 3697995.8188277525], [412872.7981374912, 3697994.8188277525], [412872.7981374912, 3697993.8188277525], [412872.7981374912, 3697992.8188277525], [412872.7981374912, 3697991.8188277525], [412872.7981374912, 3697990.8188277525], [412872.7981374912, 3697989.8188277525], [412872.7981374912, 3697988.8188277525], [412872.7981374912, 3697987.8188277525], [412872.7981374912, 3697986.8188277525], [412872.7981374912, 3697985.8188277525], [412872.7981374912, 3697984.8188277525], [412872.7981374912, 3697983.8188277525], [412872.7981374912, 3697982.8188277525], [412872.7981374912, 3697981.8188277525], [412872.7981374912, 3697980.8188277525], [412873.7981374912, 3697979.8188277525], [412873.7981374912, 3697978.8188277525], [412873.7981374912, 3697977.8188277525], [412873.7981374912, 3697976.8188277525], [412873.7981374912, 3697975.8188277525], [412873.7981374912, 3697974.8188277525], [412873.7981374912, 3697973.8188277525], [412873.7981374912, 3697972.8188277525], [412873.7981374912, 3697971.8188277525], [412873.7981374912, 3697970.8188277525], [412873.7981374912, 3697969.8188277525], [412873.7981374912, 3697968.8188277525], [412873.7981374912, 3697967.8188277525], [412873.7981374912, 3697966.8188277525], [412873.7981374912, 3697965.8188277525], [412873.7981374912, 3697964.8188277525], [412873.7981374912, 3697963.8188277525], [412873.7981374912, 3697962.8188277525], [412873.7981374912, 3697961.8188277525], [412873.7981374912, 3697960.8188277525], [412873.7981374912, 3697959.8188277525], [412873.7981374912, 3697958.8188277525], [412873.7981374912, 3697957.8188277525], [412873.7981374912, 3697956.8188277525], [412873.7981374912, 3697955.8188277525], [412873.7981374912, 3697954.8188277525], [412873.7981374912, 3697953.8188277525], [412873.7981374912, 3697952.8188277525], [412873.7981374912, 3697951.8188277525], [412873.7981374912, 3697950.8188277525], [412873.7981374912, 3697949.8188277525], [412873.7981374912, 3697948.8188277525], [412873.7981374912, 3697947.8188277525], [412873.7981374912, 3697946.8188277525], [412873.7981374912, 3697945.8188277525], [412873.7981374912, 3697944.8188277525],
        #[412873.7981374912, 3697943.8188277525], [412873.7981374912, 3697942.8188277525], [412873.7981374912, 3697941.8188277525], [412873.7981374912, 3697940.8188277525], [412873.7981374912, 3697939.8188277525], [412873.7981374912, 3697938.8188277525], [412873.7981374912, 3697937.8188277525], [412873.7981374912, 3697936.8188277525], [412873.7981374912, 3697935.8188277525], [412873.7981374912, 3697934.8188277525], [412873.7981374912, 3697933.8188277525], [412873.7981374912, 3697932.8188277525], [412873.7981374912, 3697931.8188277525], [412873.7981374912, 3697930.8188277525], [412873.7981374912, 3697929.8188277525], [412873.7981374912, 3697928.8188277525], [412873.7981374912, 3697927.8188277525], [412873.7981374912, 3697926.8188277525], [412873.7981374912, 3697925.8188277525], [412873.7981374912, 3697924.8188277525], [412873.7981374912, 3697923.8188277525], [412873.7981374912, 3697922.8188277525], [412873.7981374912, 3697921.8188277525], [412873.7981374912, 3697920.8188277525], [412873.7981374912, 3697919.8188277525], [412873.7981374912, 3697918.8188277525], [412873.7981374912, 3697917.8188277525], [412873.7981374912, 3697916.8188277525], [412873.7981374912, 3697915.8188277525], [412873.7981374912, 3697914.8188277525], [412873.7981374912, 3697913.8188277525], [412873.7981374912, 3697912.8188277525], [412873.7981374912, 3697911.8188277525], [412873.7981374912, 3697910.8188277525], [412873.7981374912, 3697909.8188277525], [412873.7981374912, 3697908.8188277525], [412873.7981374912, 3697907.8188277525], [412873.7981374912, 3697906.8188277525], [412873.7981374912, 3697905.8188277525], [412873.7981374912, 3697904.8188277525], [412873.7981374912, 3697903.8188277525], [412873.7981374912, 3697902.8188277525], [412873.7981374912, 3697901.8188277525], [412873.7981374912, 3697900.8188277525], [412873.7981374912, 3697899.8188277525], [412873.7981374912, 3697898.8188277525], [412873.7981374912, 3697897.8188277525], [412873.7981374912, 3697896.8188277525], [412873.7981374912, 3697895.8188277525], [412873.7981374912, 3697894.8188277525], [412873.7981374912, 3697893.8188277525], [412873.7981374912, 3697892.8188277525], [412873.7981374912, 3697891.8188277525], [412873.7981374912, 3697890.8188277525], [412873.7981374912, 3697889.8188277525], [412873.7981374912, 3697888.8188277525], [412873.7981374912, 3697887.8188277525], [412873.7981374912, 3697886.8188277525], [412874.7981374912, 3697885.8188277525], [412874.7981374912, 3697884.8188277525], [412874.7981374912, 3697883.8188277525], [412874.7981374912, 3697882.8188277525], [412874.7981374912, 3697881.8188277525], [412874.7981374912, 3697880.8188277525], [412874.7981374912, 3697879.8188277525], [412875.7981374912, 3697878.8188277525], [412875.7981374912, 3697877.8188277525], [412875.7981374912, 3697876.8188277525], [412875.7981374912, 3697875.8188277525], [412876.7981374912, 3697874.8188277525], [412877.7981374912, 3697873.8188277525], [412877.7981374912, 3697872.8188277525], [412877.7981374912, 3697871.8188277525], [412877.7981374912, 3697870.8188277525], [412877.7981374912, 3697869.8188277525], [412877.7981374912, 3697868.8188277525], [412878.7981374912, 3697867.8188277525], [412879.7981374912, 3697866.8188277525], [412880.7981374912, 3697865.8188277525], [412881.7981374912, 3697864.8188277525], [412882.7981374912, 3697863.8188277525], [412883.7981374912, 3697862.8188277525], [412884.7981374912, 3697861.8188277525], [412885.7981374912, 3697860.8188277525], [412886.7981374912, 3697859.8188277525], [412887.7981374912, 3697858.8188277525], [412888.7981374912, 3697857.8188277525], [412889.7981374912, 3697856.8188277525], [412890.7981374912, 3697855.8188277525], [412891.7981374912, 3697854.8188277525], [412892.7981374912, 3697853.8188277525], [412893.7981374912, 3697852.8188277525], [412893.7981374912, 3697851.8188277525], [412894.7981374912, 3697850.8188277525], [412895.7981374912, 3697849.8188277525], [412896.7981374912, 3697848.8188277525], [412897.7981374912, 3697847.8188277525], [412898.7981374912, 3697846.8188277525], [412899.7981374912, 3697845.8188277525], [412900.7981374912, 3697844.8188277525], [412901.7981374912, 3697843.8188277525], [412902.7981374912, 3697842.8188277525], [412903.7981374912, 3697841.8188277525], [412904.7981374912, 3697840.8188277525], [412905.7981374912, 3697839.8188277525], [412906.7981374912, 3697838.8188277525], [412907.7981374912, 3697837.8188277525], [412908.7981374912, 3697836.8188277525], [412909.7981374912, 3697835.8188277525], [412910.7981374912, 3697834.8188277525], [412911.7981374912, 3697833.8188277525], [412912.7981374912, 3697832.8188277525], [412913.7981374912, 3697831.8188277525], [412914.7981374912, 3697830.8188277525], [412915.7981374912, 3697829.8188277525], [412915.7981374912, 3697828.8188277525], [412916.7981374912, 3697827.8188277525], [412916.7981374912, 3697826.8188277525], [412917.7981374912, 3697825.8188277525], [412918.7981374912, 3697824.8188277525], [412919.7981374912, 3697823.8188277525], [412920.7981374912, 3697822.8188277525], [412921.7981374912, 3697821.8188277525], [412922.7981374912, 3697820.8188277525], [412923.7981374912, 3697819.8188277525], [412924.7981374912, 3697818.8188277525], [412925.7981374912, 3697817.8188277525], [412926.7981374912, 3697816.8188277525], [412927.7981374912, 3697815.8188277525], [412928.7981374912, 3697814.8188277525], [412929.7981374912, 3697813.8188277525], [412930.7981374912, 3697812.8188277525], [412931.7981374912, 3697811.8188277525], [412932.7981374912, 3697810.8188277525], [412933.7981374912, 3697809.8188277525], [412934.7981374912, 3697808.8188277525], [412935.7981374912, 3697807.8188277525], [412936.7981374912, 3697806.8188277525], [412937.7981374912, 3697805.8188277525], [412938.7981374912, 3697804.8188277525], [412939.7981374912, 3697803.8188277525], [412940.7981374912, 3697802.8188277525], [412941.7981374912, 3697801.8188277525], [412942.7981374912, 3697800.8188277525], [412943.7981374912, 3697799.8188277525], [412944.7981374912, 3697798.8188277525], [412945.7981374912, 3697797.8188277525], [412946.7981374912, 3697797.8188277525], [412947.7981374912, 3697797.8188277525], [412948.7981374912, 3697797.8188277525], [412949.7981374912, 3697797.8188277525], [412950.7981374912, 3697797.8188277525], [412951.7981374912, 3697797.8188277525], [412952.7981374912, 3697797.8188277525], [412953.7981374912, 3697797.8188277525], [412954.7981374912, 3697797.8188277525], [412955.7981374912, 3697797.8188277525], [412956.7981374912, 3697797.8188277525], [412957.7981374912, 3697797.8188277525], [412958.7981374912, 3697796.8188277525], [412959.7981374912, 3697795.8188277525], [412960.7981374912, 3697794.8188277525], [412961.7981374912, 3697793.8188277525], [412962.7981374912, 3697793.8188277525], [412963.7981374912, 3697793.8188277525], [412964.7981374912, 3697793.8188277525], [412965.7981374912, 3697793.8188277525], [412966.7981374912, 3697793.8188277525], [412967.7981374912, 3697792.8188277525], [412968.7981374912, 3697791.8188277525], [412969.7981374912, 3697791.8188277525], [412970.7981374912, 3697790.8188277525], [412971.7981374912, 3697789.8188277525], [412972.7981374912, 3697788.8188277525], [412973.7981374912, 3697787.8188277525], [412974.7981374912, 3697786.8188277525], [412975.7981374912, 3697785.8188277525], [412976.7981374912, 3697784.8188277525], [412977.7981374912, 3697783.8188277525], [412978.7981374912, 3697782.8188277525], [412979.7981374912, 3697781.8188277525], [412980.7981374912, 3697780.8188277525], [412980.7981374912, 3697779.8188277525], [412980.7981374912, 3697778.8188277525], [412980.7981374912, 3697777.8188277525], [412981.7981374912, 3697776.8188277525], [412981.7981374912, 3697775.8188277525], [412982.7981374912, 3697774.8188277525], [412983.7981374912, 3697773.8188277525], [412984.7981374912, 3697772.8188277525], [412985.7981374912, 3697771.8188277525], [412986.7981374912, 3697770.8188277525], [412986.7981374912, 3697769.8188277525], [412986.7981374912, 3697768.8188277525], [412987.7981374912, 3697767.8188277525], [412987.7981374912, 3697766.8188277525], [412987.7981374912, 3697765.8188277525], [412987.7981374912, 3697764.8188277525], [412987.7981374912, 3697763.8188277525], [412987.7981374912, 3697762.8188277525], [412987.7981374912, 3697761.8188277525], [412987.7981374912, 3697760.8188277525], [412987.7981374912, 3697759.8188277525], [412987.7981374912, 3697758.8188277525], [412987.7981374912, 3697757.8188277525], [412987.7981374912, 3697756.8188277525], [412987.7981374912, 3697755.8188277525], [412987.7981374912, 3697754.8188277525], [412987.7981374912, 3697753.8188277525], [412987.7981374912, 3697752.8188277525], [412987.7981374912, 3697751.8188277525], [412987.7981374912, 3697750.8188277525], [412988.7981374912, 3697749.8188277525], [412988.7981374912, 3697748.8188277525], [412988.7981374912, 3697747.8188277525], [412988.7981374912, 3697746.8188277525], [412988.7981374912, 3697745.8188277525], [412988.7981374912, 3697744.8188277525], [412989.7981374912, 3697743.8188277525], [412990.7981374912, 3697742.8188277525], [412990.7981374912, 3697741.8188277525], [412991.7981374912, 3697741.8188277525], [412992.7981374912, 3697741.8188277525], [412993.7981374912, 3697741.8188277525], [412994.7981374912, 3697741.8188277525], [412995.7981374912, 3697741.8188277525], [412996.7981374912, 3697741.8188277525], [412997.7981374912, 3697741.8188277525], [412998.7981374912, 3697741.8188277525]]


    response = json.dumps(path)
    return HttpResponse(response)

from skimage.graph import route_through_array
from osgeo import gdal
from pyproj import Transformer

def raster2array(rasterfn):
    raster = gdal.Open(rasterfn)
    band = raster.GetRasterBand(1)
    array = band.ReadAsArray()
    return array

# TAKES IN LAT LONG AND RETURNS PIXEL COORDS
def coord2pixelOffset(rasterfn, lat, long):
    # convert from wgs84 to 26912 to pixel
    raster = gdal.Open(rasterfn)
    #https://epsg.io/transform#s_srs=4326&t_srs=26912&ops=1728&x=-111.9296140&y=33.4207069
    transformer = Transformer.from_crs("EPSG:4326","EPSG:26912", always_xy=True)
    lat, long = transformer.transform(lat, long)
    geotransform = raster.GetGeoTransform()
    originX = geotransform[0]
    originY = geotransform[3]
    pixelWidth = geotransform[1]
    pixelHeight = geotransform[5]
    xOffset = int((lat - originX) / pixelWidth)
    yOffset = int((long - originY) / pixelHeight)
    return xOffset, yOffset

def createPath(CostSurfacefn, costSurfaceArray, startCoord, stopCoord):
    # coordinates to array index
    startCoordX = startCoord[0]
    startCoordY = startCoord[1]
    startIndexX, startIndexY = coord2pixelOffset(CostSurfacefn, startCoordX, startCoordY)

    stopCoordX = stopCoord[0]
    stopCoordY = stopCoord[1]
    stopIndexX, stopIndexY = coord2pixelOffset(CostSurfacefn, stopCoordX, stopCoordY)

    # create path
    indices, weight = route_through_array(costSurfaceArray, (startIndexX, startIndexY), (stopIndexX, stopIndexY))
    return indices, weight

def getRouteCoords(CostSurfacefn, startCoord, stopCoord, outputPathfn=None):
    costSurfaceArray = raster2array(CostSurfacefn)  # creates array from cost surface raster
    pixel_path, total_weight = createPath(CostSurfacefn, costSurfaceArray, startCoord, stopCoord)  # creates path array

    # convert pixel_path to WGS84
    raster = gdal.Open(CostSurfacefn)
    gt = raster.GetGeoTransform()

    x_min = gt[0]
    x_size = gt[1]
    y_min = gt[3]
    y_size = gt[5]

    coords = [(mx * x_size + x_min, my * y_size + y_min) for (mx,my) in pixel_path] # return cords in NAD83
    transformer = Transformer.from_crs("EPSG:26912","EPSG:4326", always_xy=True)
    coords = [transformer.transform(cx, cy)for (cx,cy) in coords]
    return coords

import os
# costsurfacefn is the solweig mrt tif file generated
# start/stop is a cooridnate in wgs84 (long, lat)
# outputPath is a file name for the output tif file
def getRoute(startCoord, stopCoord, dateTimeString):
    # check if os is unix or windows
    if os.name == 'nt':
        CostSurfacefn = f'client\\output\\masked_{dateTimeString}_mrt.tif'
    else:
        CostSurfacefn = f'client/output/masked_{dateTimeString}_mrt.tif'

    # check if file exists
    if not os.path.exists(CostSurfacefn):
        print('File does not exist')
    startCoord = startCoord  # start point in wgs84 (long, lat)
    stopCoord = stopCoord  # psych north in wgs84 (long, lat)
    # outputPathfn = 'Maps/PathFromBrickyardToNobleTestNAD.tif'
    return getRouteCoords(CostSurfacefn, startCoord, stopCoord)

# class MRTViewSet(GenericViewSet,
#                 CreateModelMixin,
#                 RetrieveModelMixin,
#                 UpdateModelMixin,
#                 ListModelMixin):
#    serializer_class = MRTSerializer
#    queryset = MRTSerializer.objects.all()
    
